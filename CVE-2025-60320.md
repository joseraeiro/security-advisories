# CVE-2025-60320 — Unquoted Service Path in memoQ Auto Update Service

**Disclosure Date:** 2025-10-29  
**CVE ID:** CVE-2025-60320  
**Discovered by:** José Raeiro (@joseraeiro)

---

## Summary
An **Unquoted Service Path** vulnerability (CWE-428) exists in the **memoQ Auto Update Service** (display name) with service name **`memoQauhlp101`** in **memoQ** versions **10.1.13.ef1b2b52aae and earlier**.  
The service is installed with a binary path containing spaces and **without surrounding quotes**. If an attacker can place an executable in an earlier searched path element (e.g., `C:\Program.exe`), Windows may execute it with **SYSTEM** privileges when the service starts.

---

## Vendor
**Vendor:** memoQ Translation Technologies  
**Product:** memoQ (Windows)  
**Affected versions:** 10.1.13.ef1b2b52aae and earlier (tested)  
**Patched version:** Vendor states latest versions are fixed (exact version pending vendor advisory)

---

## Technical Details
Example vulnerable configuration observed (service name → binary path):
```

ServiceName: memoQauhlp101
ImagePath: C:\Program Files\memoQ\memoQ-10\MemoQ.AutoUpdate.exe

````
Because the path contains spaces and lacks quotes, at service start the OS may attempt to execute:
1. `C:\Program.exe`
2. `C:\Program Files\memoQ\memoQ-10\MemoQ.AutoUpdate.exe`

**Precondition:** exploitation requires the attacker to have write access to an earlier path location (e.g., `C:\`). On properly locked-down systems, this may not be achievable for standard users.

---

## Impact
**Local Privilege Escalation** to **NT AUTHORITY\SYSTEM**.

**CVSS v3.1 (proposed):** 7.8 (AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)  
*Actual risk depends on filesystem/ACL policies.*

---

## Proof of Concept (PoC)
1. Place a controlled executable at `C:\Program.exe` (requires write access).  
2. Restart the **memoQ Auto Update Service** or reboot.  
3. The payload runs as **SYSTEM**.

*Run only in a controlled test environment.*

---

## Mitigations
- **Upgrade** to the latest vendor version where the service path is quoted.  
- **Temporary fix (run as Administrator):**
```
  sc.exe stop memoQauhlp101
  sc.exe config "memoQauhlp101" binPath= "\"C:\Program Files\memoQ\memoQ-10\MemoQ.AutoUpdate.exe\""
  sc.exe start memoQauhlp101
```

* **Hardening:** ensure unprivileged users cannot write to `C:\` or other early path elements.

**Verification:**

```cmd
sc.exe qc memoQauhlp101
reg query "HKLM\SYSTEM\CurrentControlSet\Services\memoQauhlp101" /v ImagePath
```

---

## Timeline

* **2025-08-07:** Vulnerability discovered and reported to vendor.
* **2025-08-14:** Vendor acknowledged; stated fix in latest versions.
* **2025-10-23:** CVE-2025-60320 assigned by MITRE.
* **2025-10-29:** Public advisory published.

---

## References

* CWE-428 — Unquoted Search Path or Element
* Microsoft guidance on unquoted service paths and EoP

---

## Credit

Discovered and reported by **José Raeiro**.

